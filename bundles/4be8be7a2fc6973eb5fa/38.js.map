{"version":3,"sources":["webpack:///./node_modules/matrix-react-sdk/src/components/views/rooms/wysiwyg_composer/utils/createMessageContent.ts","webpack:///./node_modules/matrix-react-sdk/src/components/views/rooms/wysiwyg_composer/utils/message.ts","webpack:///./node_modules/matrix-react-sdk/src/components/views/rooms/wysiwyg_composer/utils/isContentModified.ts","webpack:///./node_modules/matrix-react-sdk/src/components/views/rooms/wysiwyg_composer/components/EditionButtons.tsx","webpack:///./node_modules/matrix-react-sdk/src/components/views/rooms/wysiwyg_composer/hooks/useInitialContent.ts","webpack:///./node_modules/matrix-react-sdk/src/components/views/rooms/wysiwyg_composer/EditWysiwygComposer.tsx","webpack:///./node_modules/matrix-react-sdk/src/components/views/rooms/wysiwyg_composer/hooks/useWysiwygEditActionHandler.ts","webpack:///./node_modules/matrix-react-sdk/src/components/views/rooms/wysiwyg_composer/hooks/useEditing.ts"],"names":["EMOTE_PREFIX","isMatrixEvent","e","MatrixEvent","async","createMessageContent","message","isHTML","relation","replyToEvent","permalinkCreator","includeReplyLegacyFallback","editedEvent","isEditing","isReply","Boolean","replyEventId","isReplyAndEditing","isEmote","startsWith","slice","length","body","richToPlain","content","document","DOMParser","parseFromString","Array","from","querySelectorAll","forEach","mention","getAttribute","replaceWith","innerText","innerHTML","href","permalinkParts","parsePermalink","isNotNull","roomIdOrAlias","convertPlainTextToBody","bodyPrefix","mxEvent","getContent","lines","split","map","l","trim","getTextReplyFallback","formattedBodyPrefix","html","formatted_body","mxReply","querySelector","outerHTML","getHtmlReplyFallback","msgtype","MsgType","Emote","Text","isMarkdownEnabled","SettingsStore","getValue","formattedBody","plainToRich","format","_objectSpread","attachRelation","rel_type","event_id","getId","addReplyToMessageContent","includeLegacyFallback","sendMessage","_ref","_content","roomContext","mxClient","params","_objectWithoutProperties","_excluded","room","roomId","posthogEvent","eventName","isLocation","inThread","THREAD_RELATION_TYPE","name","PosthogAnalytics","instance","trackEvent","cmd","args","getCommand","threadId","commandSuccessful","runSlashCommand","category","CommandCategories","messages","effects","_content$msgtype$star","_content$msgtype","sendAnyway","shouldSendAnyway","dis","dispatch","action","Action","FocusAComposer","context","timelineRenderingType","decorateStartSendingTime","prom","doMaybeLocalRoomAction","actualRoomId","event","CHAT_EFFECTS","effect","containsEmoji","emojis","command","then","resp","sendRoundTripMetric","editMessage","editorStateTransfer","getEvent","getThread","editContent","newContent","cancelPreviousPendingEdit","createRedactEventDialog","onCloseDialog","endEditing","response","getRoomId","oldContent","isContentModified","threadRootId","EditionButtons","onCancelClick","onSaveClick","isSaveDisabled","React","createElement","className","AccessibleButton","kind","onClick","_t","disabled","useInitialContent","useRoomContext","useMatrixClientContext","useMemo","partCreator","CommandPartCreator","parts","hasEditorState","serializedParts","getSerializedParts","p","deserializePart","_editorStateTransfer$","replace","getFormattedContent","parseEvent","shouldEscape","reduce","part","text","parseEditorStateTransfer","Content","forwardRef","composerFunctions","composerElement","composerContext","useComposerContext","timeoutId","useRef","handler","useCallback","payload","_payload$context","current","TimelineRenderingType","Room","FocusEditMessageComposer","focusComposer","ComposerInsert","composerType","ComposerType","Edit","setSelection","selection","insertText","useDispatcher","defaultDispatcher","useWysiwygEditActionHandler","EditWysiwygComposer","props","defaultContextValue","getDefaultContextValue","initialContent","isReady","undefined","onChange","setIsSaveDisabled","useState","setContent","_isSaveDisabled","useEditing","ComposerContext","Provider","value","WysiwygComposer","_extends","classNames","onSend","ref","Fragment"],"mappings":"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","file":"bundles/4be8be7a2fc6973eb5fa/38.js","sourceRoot":""}