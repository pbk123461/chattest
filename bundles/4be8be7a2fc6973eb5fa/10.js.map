{"version":3,"sources":["webpack:///./node_modules/matrix-react-sdk/src/utils/MegolmExportEncryption.ts","webpack:///./node_modules/matrix-react-sdk/src/async-components/views/dialogs/security/ExportE2eKeysDialog.tsx"],"names":["subtleCrypto","window","crypto","subtle","webkitSubtle","friendlyError","message","friendlyText","cryptoFailMsg","_t","async","decryptMegolmKeyFile","data","password","body","fileStr","TextDecoder","decode","Uint8Array","lineStart","lineEnd","indexOf","Error","line","slice","trim","HEADER_LINE","dataStart","undefined","TRAILER_LINE","dataEnd","base64","latin1String","atob","uint8Array","length","i","charCodeAt","decodeBase64","unpackMegolmKeyFile","brand","SdkConfig","get","ciphertextLength","salt","subarray","iv","iterations","ciphertext","hmac","aesKey","hmacKey","deriveKeys","toVerify","isValid","plaintext","verify","name","e","decrypt","counter","encryptMegolmKeyFile","options","kdfRounds","kdf_rounds","getRandomValues","encodedData","TextEncoder","encode","encrypt","cipherArray","bodyLength","resultBuffer","idx","set","toSign","sign","hmacArray","LINE_LENGTH","nLines","Math","ceil","lines","Array","o","encodeBase64","join","buffer","packMegolmKeyFile","start","Date","key","keybits","importKey","deriveBits","hash","now","logger","log","getTime","aesProm","catch","hmacProm","Promise","all","String","fromCharCode","apply","from","btoa","Phase","ExportE2eKeysDialog","React","Component","constructor","props","super","_defineProperty","ev","preventDefault","this","verifyFieldsBeforeSubmit","unmounted","passphrase","state","passphrase1","startExport","onFinished","phrase","setState","target","value","phase","Edit","errStr","passphrase2","componentWillUnmount","fieldsInDisplayOrder","fieldPassword","fieldPasswordConfirm","invalidFields","field","validate","allowEmpty","push","focus","focused","resolve","then","matrixClient","exportRoomKeys","k","MegolmExportEncryption","JSON","stringify","f","blob","Blob","type","FileSaver","saveAs","error","msg","Exporting","render","disableForm","createElement","BaseDialog","className","title","onSubmit","onPassphraseFormSubmit","PassphraseField","minScore","label","_td","labelEnterPassword","labelStrongPassword","labelAllowedButUnsafe","onChange","onPassphraseChange","autoFocus","size","disabled","autoComplete","fieldRef","PassphraseConfirmField","labelRequired","labelInvalid","onClick","onCancelClick"],"mappings":"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","file":"bundles/4be8be7a2fc6973eb5fa/10.js","sourceRoot":""}